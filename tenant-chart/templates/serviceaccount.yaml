{{ range .Values.apps }}
{{- if .serviceAccount.create -}}
apiVersion: v1
kind: ServiceAccount
metadata:
  name: {{ .appName }}
labels:
  app.kubernetes.io/name: "{{$.Chart.Name}}-{{$.Chart.Version }}"
  app.kubernetes.io/instance: "{{ $.Release.Name }}"
  app.kubernetes.io/version: "{{ $.Chart.AppVersion  }}"
  app.kubernetes.io/managed-by: "{{ $.Release.Service }}"
{{- with .serviceAccount.annotations }}
annotations:
  {{- toYaml . | nindent 4 }}
{{- end }}
{{- end }}
{{ end }}
